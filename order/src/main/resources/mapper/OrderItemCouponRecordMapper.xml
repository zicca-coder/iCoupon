<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zicca.icoupon.order.dao.mapper.OrderItemCouponRecordMapper">

    <sql id="table">
        t_order_item_coupon_record
    </sql>

    <sql id="baseColumn">
        id
        ,
        order_item_id,
        goods_id,
        user_coupon_id,
        user_id
    </sql>

    <sql id="column">
        <include refid="baseColumn"/>,
        create_time,
        update_time,
        create_by,
        update_by,
        del_flag
    </sql>

    <sql id="insertColumn">
        <include refid="column"/>
    </sql>

    <sql id="insertValues">
        #{record.id}
        ,
        #{record.orderItemId},
        #{record.goodsId},
        #{record.userCouponId},
        #{record.userId},
        #{record.createTime},
        #{record.updateTime},
        #{record.createBy},
        #{record.updateBy},
        #{record.delFlag}
    </sql>

    <select id="selectRecordById" resultType="com.zicca.icoupon.order.dao.entity.OrderItemCouponRecord">
        SELECT
        <include refid="column"/>
        FROM
        <include refid="table"/>
        WHERE id = #{id}
        AND del_flag = 0
    </select>

    <select id="selectRecordByIdAndUserId" resultType="com.zicca.icoupon.order.dao.entity.OrderItemCouponRecord">
        SELECT
        <include refid="column"/>
        FROM
        <include refid="table"/>
        WHERE id = #{id}
        AND user_id = #{userId}
        AND del_flag = 0
    </select>

    <select id="selectRecordListByOrderItemId" resultType="com.zicca.icoupon.order.dao.entity.OrderItemCouponRecord">
        SELECT
        <include refid="column"/>
        FROM
        <include refid="table"/>
        WHERE order_item_id = #{orderItemId}
        AND del_flag = 0
    </select>

    <select id="selectRecordListByOrderItemIdAndUserId"
            resultType="com.zicca.icoupon.order.dao.entity.OrderItemCouponRecord">
        SELECT
        <include refid="column"/>
        FROM
        <include refid="table"/>
        WHERE order_item_id = #{orderItemId}
        AND user_id = #{userId}
        AND del_flag = 0
    </select>

    <select id="selectRecordListByIdsAndUserId" resultType="com.zicca.icoupon.order.dao.entity.OrderItemCouponRecord">
        SELECT
        <include refid="column"/>
        FROM
        <include refid="table"/>
        WHERE id IN
        <foreach item="id" index="index" collection="ids" separator="," open="(" close=")">
            #{id}
        </foreach>
    </select>

    <insert id="insertRecord">
        INSERT INTO
        <include refid="table"/>
        (
        <include refid="insertColumn"/>
        )
        VALUES
        (
        <include refid="insertValues"/>
        )
    </insert>

    <insert id="batchInsertRecord">
        INSERT INTO
        <include refid="table"/>
        (
        <include refid="insertColumn"/>
        )
        VALUES
        <foreach item="record" index="index" collection="recordList" separator=",">
            (
            <include refid="insertValues"/>
            )
        </foreach>
    </insert>

    <delete id="deleteRecordById" >
        DELETE
        FROM
        <include refid="table"/>
        WHERE id = #{id}
        AND del_flag = 0
    </delete>

    <delete id="deleteRecordByIdAndUserId" >
        DELETE
        FROM
        <include refid="table"/>
        WHERE id = #{id}
        user_id = #{userId}
        AND del_flag = 0
    </delete>

    <delete id="batchDeleteRecordByIds">
        DELETE
        FROM
        <include refid="table"/>
        WHERE id IN
        <foreach item="id" index="index" collection="ids" separator="," open="(" close=")">
            #{id}
        </foreach>
        AND del_flag = 0
    </delete>

    <delete id="batchDeleteRecordByIdsAndUserId">
        DELETE
        FROM
        <include refid="table"/>
        WHERE id IN
        <foreach item="id" index="index" collection="ids" separator="," open="(" close=")">
            #{id}
        </foreach>
        AND user_id = #{userId}
        AND del_flag = 0
    </delete>

    <delete id="batchDeleteRecordByOrderItemId">
        DELETE
        FROM
        <include refid="table"/>
        WHERE order_item_id = #{orderItemId}
        AND del_flag = 0
    </delete>

    <delete id="batchDeleteRecordByOrderItemIdAndUserId">
        DELETE
        FROM
        <include refid="table"/>
        WHERE order_item_id = #{orderItemId}
        AND user_id = #{userId}
        AND del_flag = 0
    </delete>

</mapper>